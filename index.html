<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Style Network Visualization</title>
    <!-- D3.js from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <!-- Load the CSS file -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Music Style Network Visualization</h1>
    
    <div class="controls">
        <h3 class="control-heading">Visualization Controls</h3>
        
        <div class="controls-row">
            <div class="control-item">
                <div class="control-label">Year:</div>
                <select id="year-select" class="select-control">
                    <!-- Options will be populated dynamically from 2000-2024 -->
                </select>
            </div>
            
            <div class="control-item">
                <div class="control-label">Filter by Style:</div>
                <select id="style-select" class="select-control">
                    <option value="">Show All Styles</option>
                    <!-- Options will be populated dynamically -->
                </select>
            </div>
            
            <div class="control-item">
                <div class="control-label">Number of Top Nodes:</div>
                <input type="range" min="5" max="300" value="100" class="slider" id="top-nodes-slider">
                <div class="value-container"><span id="top-nodes-value" class="value-display">100</span></div>
            </div>
            
            <div class="control-item">
                <div class="control-label">Node Spacing:</div>
                <input type="range" min="1" max="100" value="90" class="slider" id="spacing-slider">
                <div class="value-container"><span id="node-spacing-value" class="value-display">90</span></div>
            </div>
            
            <div class="control-item">
                <div class="control-label">Link Curvature:</div>
                <input type="range" min="0" max="100" value="100" class="slider" id="curve-slider">
                <div class="value-container"><span id="curve-value" class="value-display">100</span></div>
            </div>
            
            <div class="control-item">
                <div class="control-label">Node Stickiness:</div>
                <input type="range" min="1" max="100" value="30" class="slider" id="stickiness-slider">
                <div class="value-container"><span id="stickiness-value" class="value-display">30</span></div>
            </div>
        </div>
        
        <div class="button-container">
            <button id="update-button">Update Visualization</button>
            <button id="reset-zoom-button">Reset Zoom</button>
            <button id="fit-button">Fit All Nodes</button>
        </div>
        
        <div id="error-message"></div>
    </div>
    
    <div id="visualization-container">
        <div class="loading">Loading data...</div>
        <div class="year-display" id="year-display">2020</div>
        <svg id="network-svg">
            <g id="zoom-container">
                <g id="link-container"></g>
                <g id="node-container"></g>
            </g>
        </svg>
        <!-- Add legend -->
        <div class="legend">
            <h4 style="margin-top: 0; margin-bottom: 10px;">Legend</h4>
            <div class="legend-item">
                <div class="legend-major"></div>
                <span>Major Style</span>
            </div>
            <div class="legend-item">
                <div class="legend-normal"></div>
                <span>Other Style</span>
            </div>
        </div>
    </div>
    
    <div class="tooltip" id="tooltip" style="display: none;"></div>
    
    <div style="margin-top: 20px;">
        <h2>Instructions</h2>
        <ul>
            <li>Use the <strong>Year</strong> dropdown to select the year you want to visualize.</li>
            <li>Use the <strong>Filter by Style</strong> dropdown to highlight a specific music style and its connections.</li>
            <li>You can also <strong>click on any node</strong> to filter by that style.</li>
            <li>Select "Show All Styles" to remove the filter and show all connections.</li>
            <li>Adjust the <strong>Number of Top Nodes</strong> to show more or fewer music styles.</li>
            <li>The <strong>Node Spacing</strong> slider adjusts how far apart the nodes are positioned.</li>
            <li>Control the <strong>Link Curvature</strong> to adjust how curved the connection lines are.</li>
            <li>The <strong>Node Stickiness</strong> slider controls how quickly nodes settle after being moved.</li>
            <li>Use <strong>Reset Zoom</strong> to return to the default view.</li>
            <li>Click <strong>Fit All Nodes</strong> to ensure all nodes are visible in the viewport.</li>
            <li>You can <strong>drag nodes</strong> to reposition them manually.</li>
            <li><strong>Zoom and pan</strong> with mouse wheel and drag.</li>
        </ul>
        <p><em>Note: This visualization loads data from CSV files in the "data" directory. You need to start a local web server to avoid CORS issues.</em></p>
    </div>

    <!-- Load the JavaScript files -->
    <script src="styles.js"></script>
    <script src="visualization.js"></script>
</body>
</html>